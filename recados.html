<script>
  const RECADOS_URL = "https://script.google.com/macros/s/AKfycbxn3LAcvUlGiKBwdAf9rsXq9rDVQQWK_6WVDW3cGFvuA9M7J-2MVykv0tg8hNn9fdTzUA/exec";
  const form = document.getElementById("formRecado");
  const lista = document.getElementById("listaRecados");

  function carregarRecados() {
    fetch(RECADOS_URL)
      .then(r => r.json())
      .then(recados => {
        lista.innerHTML = recados.reverse().map(r => `
          <div class="recado" data-aos="fade-up">
            <p><strong>${r.nome}</strong> escreveu em ${r.data}:</p>
            <p>${r.texto}</p>
          </div>
        `).join("");
      })
      .catch(() => {
        lista.innerHTML = "<p>Erro ao carregar recados.</p>";
      });
  }

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    const nome = document.getElementById("nome").value.trim();
    const texto = document.getElementById("mensagem").value.trim();
    if (!nome || !texto) return;

    const payload = { nome, texto };

    fetch(RECADOS_URL, {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "application/json" }
    })
    .then(() => {
      form.reset();
      carregarRecados();
    })
    .catch(() => {
      alert("Erro ao enviar recado.");
    });
  });

  carregarRecados();
</script>
